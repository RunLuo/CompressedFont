# 字体压缩工具

一个基于 fonttools 的批量字体压缩工具，可以根据指定的字符集对字体文件进行子集化处理，大幅减小字体文件大小。

## 功能特性

- 🚀 **批量处理**：支持一次性处理多个字体文件
- 📁 **多格式支持**：支持 TTF、OTF、WOFF、WOFF2、TTC 等常见字体格式
- 📊 **压缩统计**：显示压缩前后文件大小对比和压缩率
- 🛡️ **错误处理**：完善的错误处理和状态反馈
- 📝 **详细日志**：处理过程中的详细日志输出

## 目录结构

```
字体压缩脚本/
├── main.py          # 主程序文件
├── txt.txt          # 字符集文件（包含需要保留的字符）
├── sourceFont/      # 源字体文件目录
│   ├── MSYH.TTC
│   ├── MSYHBD.TTC
│   ├── MSYHL.TTC
│   └── Optima.ttc
├── targetFont/      # 压缩后字体输出目录
└── README.md        # 说明文档
```

## 安装依赖

在运行程序之前，需要安装 fonttools：

```bash
pip install fonttools
```

## 使用方法

### 1. 准备字体文件
将需要压缩的字体文件放入 `sourceFont/` 目录中。

### 2. 配置字符集
`txt.txt` 文件包含了现代汉语常用3500字和常用特殊字符，如需自定义字符集，可以编辑此文件。

### 3. 运行压缩程序
```bash
python main.py
```

### 4. 查看结果
压缩后的字体文件将保存在 `targetFont/` 目录中，文件名格式为 `原文件名-subset.扩展名`。

## 字符集说明

`txt.txt` 文件包含：
- **现代汉语常用3500字**：覆盖日常使用的绝大部分汉字
- **特殊字符**：标点符号、数字、英文字母、希腊字母等
- **其他符号**：数学符号、单位符号、特殊标记等

这个字符集在保证常用性的同时，能够显著减小字体文件大小。

## 压缩效果

通常情况下，使用常用字符集进行子集化可以将字体文件大小压缩 **70-90%**，具体压缩率取决于：
- 原始字体包含的字符数量
- 字符集的大小
- 字体的格式和设计复杂度

## 支持的字体格式

- **.ttf** - TrueType Font
- **.otf** - OpenType Font  
- **.woff** - Web Open Font Format
- **.woff2** - Web Open Font Format 2.0
- **.ttc** - TrueType Collection

## 注意事项

1. **备份原文件**：压缩前请备份原始字体文件
2. **字符缺失**：压缩后的字体只包含指定字符集中的字符，其他字符将无法显示
3. **许可证**：请确保字体文件的使用符合相关许可证要求
4. **测试验证**：压缩后建议测试字体在实际应用中的显示效果

## 错误排查

### fonttools 未安装
```
❌ 错误：未找到 fonttools 工具，请先安装：pip install fonttools
```
**解决方案**：运行 `pip install fonttools` 安装依赖

### 源目录不存在
```
❌ 源字体目录不存在：sourceFont
```
**解决方案**：创建 `sourceFont` 目录并放入字体文件

### 字符集文件不存在
```
❌ 字符集文件不存在：txt.txt
```
**解决方案**：确保 `txt.txt` 文件存在且包含需要的字符

## 技术原理

本工具基于 Google 的 fonttools 库，使用字体子集化（font subsetting）技术：

1. **字符分析**：读取指定的字符集文件
2. **字体解析**：解析原始字体文件结构
3. **子集提取**：只保留字符集中包含的字符
4. **重新生成**：生成新的字体文件

这种方法可以在保持字体质量的同时，大幅减小文件大小，特别适合中文字体的优化。

## 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个工具！
